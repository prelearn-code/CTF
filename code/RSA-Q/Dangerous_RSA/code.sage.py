

# This file was *autogenerated* from the file code.sage
from sage.all_cmdline import *   # import sage library

_sage_const_7 = Integer(7); _sage_const_8 = Integer(8); _sage_const_50 = Integer(50)
import binascii

# 1. 输入题目数据
# 注意：Python/Sage 处理十六进制字符串时，末尾的 'L' (长整型标记) 需要去掉
n_hex = "0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793"
e_hex = "0x3"
c_hex = "0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365"

# 2. 转换为整数

n = Integer(n_hex.replace("L", ""))
e = Integer(e_hex.replace("L", ""))
c = Integer(c_hex.replace("L", ""))

def simple_rsa_crack():
    print("[*] 检查是否满足直接开方条件...")
    
    # 检查 c 是否小于 n (这通常意味着没有发生取模，或者取模次数很少)
    if c < n:
        print("[+] c < n，很有可能是直接立方！")
    
    # 3. 尝试直接开 e 次方
    # try_nth_root 是 SageMath 的方法，如果存在整数根则返回，否则返回 None
    # 或者直接用 c.nth_root(e)
    try:
        m = c.nth_root(e)
        print(f"[+] 成功开方，得到 m: {m}")
        
        # 4. 转码为字符串
        # 同样使用原生方法避免 import Crypto
        m_int = int(m) # 转为 Python int 方便处理
        flag_bytes = m_int.to_bytes((m_int.bit_length() + _sage_const_7 ) // _sage_const_8 , byteorder='big')
        print("-" * _sage_const_50 )
        print(f"Flag: {flag_bytes.decode('utf-8')}")
        print("-" * _sage_const_50 )
        
    except ValueError:
        print("[-] 开方失败，c 不是完美的 e 次方数。可能需要考虑 m^e = c + k*n 的情况。")

if __name__ == "__main__":
    simple_rsa_crack()

