

# This file was *autogenerated* from the file code.sage
from sage.all_cmdline import *   # import sage library

_sage_const_920139713 = Integer(920139713); _sage_const_19 = Integer(19); _sage_const_704796792 = Integer(704796792); _sage_const_752211152 = Integer(752211152); _sage_const_274704164 = Integer(274704164); _sage_const_18414022 = Integer(18414022); _sage_const_368270835 = Integer(368270835); _sage_const_483295235 = Integer(483295235); _sage_const_263072905 = Integer(263072905); _sage_const_459788476 = Integer(459788476); _sage_const_663551792 = Integer(663551792); _sage_const_475206804 = Integer(475206804); _sage_const_428313374 = Integer(428313374); _sage_const_425392137 = Integer(425392137); _sage_const_458265677 = Integer(458265677); _sage_const_341524652 = Integer(341524652); _sage_const_534149509 = Integer(534149509); _sage_const_828509797 = Integer(828509797); _sage_const_306220148 = Integer(306220148); _sage_const_0 = Integer(0); _sage_const_1 = Integer(1); _sage_const_50 = Integer(50)# 1. 定义题目参数
N = _sage_const_920139713 
e = _sage_const_19 
ciphertexts = [
    _sage_const_704796792 , _sage_const_752211152 , _sage_const_274704164 , _sage_const_18414022 , _sage_const_368270835 , 
    _sage_const_483295235 , _sage_const_263072905 , _sage_const_459788476 , _sage_const_483295235 , _sage_const_459788476 , 
    _sage_const_663551792 , _sage_const_475206804 , _sage_const_459788476 , _sage_const_428313374 , _sage_const_475206804 , 
    _sage_const_459788476 , _sage_const_425392137 , _sage_const_704796792 , _sage_const_458265677 , _sage_const_341524652 , 
    _sage_const_483295235 , _sage_const_534149509 , _sage_const_425392137 , _sage_const_428313374 , _sage_const_425392137 , 
    _sage_const_341524652 , _sage_const_458265677 , _sage_const_263072905 , _sage_const_483295235 , _sage_const_828509797 , 
    _sage_const_341524652 , _sage_const_425392137 , _sage_const_475206804 , _sage_const_428313374 , _sage_const_483295235 , 
    _sage_const_475206804 , _sage_const_459788476 , _sage_const_306220148 
]

def solve_small_n():
    print("[*] 正在分解 N ...")
    
    # 2. 分解 N (因为 N 很小，factor 函数瞬间完成)
    factors = factor(N)
    print(f"[+] 因子: {factors}")
    
    # 获取 p 和 q (SageMath 的 factor 返回的是 tuple 列表)
    p = factors[_sage_const_0 ][_sage_const_0 ]
    q = factors[_sage_const_1 ][_sage_const_0 ]
    
    # 3. 计算 phi 和 d
    phi = (p - _sage_const_1 ) * (q - _sage_const_1 )
    d = inverse_mod(e, phi)
    print(f"[+] 计算出私钥 d: {d}")
    
    # 4. 循环解密列表 (RSA Roll!)
    flag = ""
    print("[*] 开始逐字解密...")
    
    for c in ciphertexts:
        # m = c^d mod N
        m = power_mod(c, d, N)
        try:
            flag += chr(m)
        except:
            flag += "?"
            
    print("-" * _sage_const_50 )
    print(f"Flag: {flag}")
    print("-" * _sage_const_50 )

if __name__ == "__main__":
    solve_small_n()

